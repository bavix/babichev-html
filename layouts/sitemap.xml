{{ printf "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>" | safeHTML }}
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:xhtml="http://www.w3.org/1999/xhtml">
  {{- $excludeErrors := slice "/404.html" "/403.html" "/500.html" "/502.html" "/503.html" -}}
  {{- range .Site.RegularPages -}}
    {{- $shouldExclude := false -}}
    {{- range $excludeErrors -}}
      {{- if eq $.RelPermalink . -}}
        {{- $shouldExclude = true -}}
      {{- end -}}
    {{- end -}}
    {{- if not $shouldExclude -}}
      {{- $priority := 0.5 -}}
      {{- $changefreq := "monthly" -}}
      {{- if eq .Section "projects" -}}
        {{- $priority = 0.8 -}}
        {{- $changefreq = "monthly" -}}
      {{- else if eq .Section "articles" -}}
        {{- $priority = 0.8 -}}
        {{- $changefreq = "monthly" -}}
      {{- end -}}
      {{- if .Params.sitemap -}}
        {{- if isset .Params.sitemap "priority" -}}
          {{- $priority = .Params.sitemap.priority -}}
        {{- end -}}
        {{- if isset .Params.sitemap "changefreq" -}}
          {{- $changefreq = .Params.sitemap.changefreq -}}
        {{- end -}}
        {{- if eq .Params.sitemap.disable true -}}
          {{- $shouldExclude = true -}}
        {{- end -}}
      {{- end -}}
      {{- if not $shouldExclude -}}
  <url>
    <loc>{{ .Permalink | absURL }}</loc>
    <lastmod>{{ .Lastmod.Format "2006-01-02T15:04:05-07:00" | default (.Date.Format "2006-01-02T15:04:05-07:00") }}</lastmod>
    <changefreq>{{ $changefreq }}</changefreq>
    <priority>{{ $priority }}</priority>
  </url>
      {{- end -}}
    {{- end -}}
  {{- end -}}
  {{- range .Site.Sections -}}
    {{- $shouldExclude := false -}}
    {{- range $excludeErrors -}}
      {{- if eq $.RelPermalink . -}}
        {{- $shouldExclude = true -}}
      {{- end -}}
    {{- end -}}
    {{- if not $shouldExclude -}}
      {{- $priority := 0.6 -}}
      {{- $changefreq := "weekly" -}}
      {{- if eq .Section "projects" -}}
        {{- $priority = 0.7 -}}
      {{- else if eq .Section "articles" -}}
        {{- $priority = 0.7 -}}
      {{- end -}}
      {{- $lastmod := now.Format "2006-01-02T15:04:05-07:00" -}}
      {{- if and .Lastmod (not .Lastmod.IsZero) -}}
        {{- $lastmod = .Lastmod.Format "2006-01-02T15:04:05-07:00" -}}
      {{- end -}}
  <url>
    <loc>{{ .Permalink | absURL }}</loc>
    <lastmod>{{ $lastmod }}</lastmod>
    <changefreq>{{ $changefreq }}</changefreq>
    <priority>{{ $priority }}</priority>
  </url>
    {{- end -}}
  {{- end -}}
  {{- $home := .Site.Home -}}
  {{- if $home -}}
  <url>
    <loc>{{ $home.Permalink | absURL }}</loc>
    <lastmod>{{ $home.Lastmod.Format "2006-01-02T15:04:05-07:00" | default (now.Format "2006-01-02T15:04:05-07:00") }}</lastmod>
    <changefreq>weekly</changefreq>
    <priority>1.0</priority>
  </url>
  {{- end -}}
</urlset>
